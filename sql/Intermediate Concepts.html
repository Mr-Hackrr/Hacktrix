<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intermediate SQL - TechyVia</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <link rel="stylesheet" href="style.css"> <!-- Assuming your CSS file is named styles.css -->
</head>
<body>
    <!-- Header Bar -->
    <header class="header-bar">
        <span class="brand-name">TechyVia</span>
        <nav class="navbar">
            <ul class="nav-links">
                <li><a href="#about" class="nav-link">About</a></li>
                <li><a href="#exercise" class="nav-link">Exercise</a></li>
                <li><a href="#project" class="nav-link">Project</a></li>
                <li><a href="#contact" class="nav-link">Contact Us</a></li>
            </ul>
        </nav>
        <div class="toggle-menu" id="toggle-menu">☰</div>
    </header>

    <!-- Sidebar -->
    <div id="sideMenu" class="sideMenu" role="navigation" aria-label="Sidebar Navigation">
        <a href="#" class="closebtn" aria-label="Close sidebar">×</a>
        <nav class="sidebar-nav">
            <ul class="sidebar-links">
                <li class="sidebar-link"><a href="#joins" tabindex="0">Joins</a></li>
                <li class="sidebar-link"><a href="#subqueries" tabindex="0">Subqueries</a></li>
                <li class="sidebar-link"><a href="#group-by-having" tabindex="0">GROUP BY and HAVING Clauses</a></li>
                <li class="sidebar-link"><a href="#indexing-constraints" tabindex="0">Indexing and Constraints</a></li>
                <li class="sidebar-link"><a href="#views-stored-procedures" tabindex="0">Views and Stored Procedures</a></li>
                <li class="sidebar-link"><a href="#database-design" tabindex="0">Database Design</a></li>
            </ul>
        </nav>
    </div>

    <!-- Content -->
    <div id="content">
        <h1>Intermediate SQL</h1>
        <!-- Content will go here -->

 <!-- Intermediate SQL Content: Joins -->
 <section id="joins" class="margin-lg padding-md box-shadow">
    <h1>SQL Joins: Combining Data</h1>
    <p>
        SQL Joins are used to retrieve data from multiple tables based on related columns. They are essential for answering questions that involve relationships between datasets.
    </p>

    <h2>Why Use Joins?</h2>
    <ul>
        <li>To combine data from multiple sources into a single result set.</li>
        <li>To analyze relationships between datasets, such as customers and their orders.</li>
        <li>To ensure meaningful data retrieval for complex queries.</li>
    </ul>

    <h2>Types of Joins</h2>
    <ul>
        <li><strong>INNER JOIN</strong> - Retrieves matching rows from both tables.</li>
        <li><strong>LEFT JOIN</strong> - Includes all rows from the left table and matching rows from the right table.</li>
        <li><strong>RIGHT JOIN</strong> - Includes all rows from the right table and matching rows from the left table.</li>
        <li><strong>FULL OUTER JOIN</strong> - Combines all rows from both tables, filling unmatched rows with NULLs.</li>
    </ul>

    <hr>

    <!-- INNER JOIN -->
    <div class="join-section">
        <h2>INNER JOIN</h2>
        <p>
            An <strong>INNER JOIN</strong> retrieves rows with matching values in both tables. It excludes rows that do not have matches in the other table.
        </p>

        <h3>Example Scenario</h3>
        <p>Consider two tables:</p>

        <div class="example-tables">
            <div class="table-wrapper" style="display: inline-block; width: 45%; margin-right: 5%;">
                <h4>Customers Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Customer ID</th>
                            <th>Customer Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>John Doe</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Jane Smith</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Emily Johnson</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="table-wrapper" style="display: inline-block; width: 45%;">
                <h4>Orders Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>101</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>102</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>103</td>
                            <td>4</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT customers.customer_name, orders.order_id
FROM customers
INNER JOIN orders
ON customers.customer_id = orders.customer_id;</code></pre>
        </div>

        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Order ID</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>John Doe</td>
                    <td>101</td>
                </tr>
                <tr>
                    <td>Jane Smith</td>
                    <td>102</td>
                </tr>
            </tbody>
        </table>

        <h3>Visual Representation</h3>
        <div class="joins-visual" style="text-align: center;">
            <svg viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg" class="join-diagram" style="width: 80%; max-width: 300px; height: auto;">
                <circle cx="100" cy="75" r="60" fill="#3498db" fill-opacity="0.6" />
                <circle cx="200" cy="75" r="60" fill="#e74c3c" fill-opacity="0.6" />
                <text x="140" y="80" font-size="12" fill="#fff" text-anchor="middle">Matching Rows</text>
            </svg>
            <p>
                The overlapping area shows rows where <strong>Customer ID</strong> matches between the Customers and Orders tables.
            </p>
        </div>

        <h3>Explanation</h3>
        <p>
            The query retrieves orders that have matching customer IDs in the Customers table. For example:
        </p>
        <ul>
            <li>John Doe (Customer ID 1) placed Order 101.</li>
            <li>Jane Smith (Customer ID 2) placed Order 102.</li>
        </ul>
    </div>
    <div class="join-section">
        <h2>LEFT JOIN</h2>
        <p>
            A <strong>LEFT JOIN</strong> retrieves all rows from the left table and the matching rows from the right table. Rows from the left table without matches in the right table will have NULLs for the right table's columns.
        </p>
    
        <h3>Example Scenario</h3>
        <p>Consider the same two tables:</p>
        <div class="example-tables">
            <div class="table-wrapper" style="display: inline-block; width: 45%; margin-right: 5%;">
                <h4>Customers Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Customer ID</th>
                            <th>Customer Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>John Doe</td></tr>
                        <tr><td>2</td><td>Jane Smith</td></tr>
                        <tr><td>3</td><td>Emily Johnson</td></tr>
                    </tbody>
                </table>
            </div>
    
            <div class="table-wrapper" style="display: inline-block; width: 45%;">
                <h4>Orders Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>101</td><td>1</td></tr>
                        <tr><td>102</td><td>2</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    
        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT customers.customer_name, orders.order_id
    FROM customers
    LEFT JOIN orders
    ON customers.customer_id = orders.customer_id;</code></pre>
        </div>
    
        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Order ID</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>John Doe</td><td>101</td></tr>
                <tr><td>Jane Smith</td><td>102</td></tr>
                <tr><td>Emily Johnson</td><td>NULL</td></tr>
            </tbody>
        </table>
    
        <h3>Visual Representation</h3>
        <div class="joins-visual" style="text-align: center;">
            <svg viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg" class="join-diagram" style="width: 80%; max-width: 300px; height: auto;">
                <circle cx="100" cy="75" r="60" fill="#3498db" fill-opacity="0.6" />
                <circle cx="200" cy="75" r="60" fill="#e74c3c" fill-opacity="0.2" />
                <text x="120" y="80" font-size="12" fill="#fff" text-anchor="middle">Left Rows</text>
            </svg>
            <p>
                The left circle includes all rows from the Customers table, with matches from the Orders table included in the overlap.
            </p>
        </div>
    
        <h3>Explanation</h3>
        <p>
            This query retrieves all customers, including those who have not placed any orders. For example, Emily Johnson has no orders, so her row has <strong>NULL</strong> for the Order ID.
        </p>
    </div>
    <div class="join-section">
        <h2>RIGHT JOIN</h2>
        <p>
            A <strong>RIGHT JOIN</strong> retrieves all rows from the right table and the matching rows from the left table. Rows from the right table without matches in the left table will have <strong>NULL</strong> values for the left table's columns.
        </p>
    
        <h3>Example Scenario</h3>
        <p>Consider the same two tables:</p>
        <div class="example-tables">
            <div class="table-wrapper" style="display: inline-block; width: 45%; margin-right: 5%;">
                <h4>Customers Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Customer ID</th>
                            <th>Customer Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>John Doe</td></tr>
                        <tr><td>2</td><td>Jane Smith</td></tr>
                    </tbody>
                </table>
            </div>
    
            <div class="table-wrapper" style="display: inline-block; width: 45%;">
                <h4>Orders Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>101</td><td>1</td></tr>
                        <tr><td>102</td><td>2</td></tr>
                        <tr><td>103</td><td>4</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    
        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT customers.customer_name, orders.order_id
    FROM customers
    RIGHT JOIN orders
    ON customers.customer_id = orders.customer_id;</code></pre>
        </div>
    
        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Order ID</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>John Doe</td><td>101</td></tr>
                <tr><td>Jane Smith</td><td>102</td></tr>
                <tr><td>NULL</td><td>103</td></tr>
            </tbody>
        </table>
    
        <h3>Visual Representation</h3>
        <div class="joins-visual" style="text-align: center;">
            <svg viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg" class="join-diagram" style="width: 80%; max-width: 300px; height: auto;">
                <circle cx="100" cy="75" r="60" fill="#3498db" fill-opacity="0.2" />
                <circle cx="200" cy="75" r="60" fill="#e74c3c" fill-opacity="0.6" />
                <text x="200" y="80" font-size="12" fill="#fff" text-anchor="middle">Right Rows</text>
            </svg>
            <p>
                The right circle includes all rows from the Orders table, with matches from the Customers table included in the overlap.
            </p>
        </div>
    
        <h3>Explanation</h3>
        <p>
            This query retrieves all orders, including those without matching customer records. For example:
        </p>
        <ul>
            <li>Order 101 and 102 have matching customer records (John Doe and Jane Smith).</li>
            <li>Order 103 has no matching customer, so the <strong>Customer Name</strong> is <strong>NULL</strong>.</li>
        </ul>
    </div>
    <div class="join-section">
        <h2>FULL OUTER JOIN</h2>
        <p>
            A <strong>FULL OUTER JOIN</strong> retrieves all rows from both tables. Rows without matches in the other table will have <strong>NULL</strong> values for the columns of the unmatched table.
        </p>
    
        <h3>Example Scenario</h3>
        <p>Consider the same two tables:</p>
        <div class="example-tables">
            <div class="table-wrapper" style="display: inline-block; width: 45%; margin-right: 5%;">
                <h4>Customers Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Customer ID</th>
                            <th>Customer Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>John Doe</td></tr>
                        <tr><td>2</td><td>Jane Smith</td></tr>
                        <tr><td>3</td><td>Emily Johnson</td></tr>
                    </tbody>
                </table>
            </div>
    
            <div class="table-wrapper" style="display: inline-block; width: 45%;">
                <h4>Orders Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>101</td><td>1</td></tr>
                        <tr><td>102</td><td>2</td></tr>
                        <tr><td>103</td><td>4</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    
        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT customers.customer_name, orders.order_id
    FROM customers
    FULL OUTER JOIN orders
    ON customers.customer_id = orders.customer_id;</code></pre>
        </div>
    
        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Order ID</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>John Doe</td><td>101</td></tr>
                <tr><td>Jane Smith</td><td>102</td></tr>
                <tr><td>Emily Johnson</td><td>NULL</td></tr>
                <tr><td>NULL</td><td>103</td></tr>
            </tbody>
        </table>
    
        <h3>Visual Representation</h3>
        <div class="joins-visual" style="text-align: center;">
            <svg viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg" class="join-diagram" style="width: 80%; max-width: 300px; height: auto;">
                <circle cx="100" cy="75" r="60" fill="#3498db" fill-opacity="0.4" />
                <circle cx="200" cy="75" r="60" fill="#e74c3c" fill-opacity="0.4" />
                <text x="100" y="80" font-size="12" fill="#fff" text-anchor="middle">Left Rows</text>
                <text x="200" y="80" font-size="12" fill="#fff" text-anchor="middle">Right Rows</text>
                <text x="150" y="100" font-size="12" fill="#fff" text-anchor="middle">Matching Rows</text>
            </svg>
            <p>
                Both circles represent all rows from the Customers and Orders tables. The overlapping area shows matches, while the non-overlapping areas show unmatched rows.
            </p>
        </div>
    
        <h3>Explanation</h3>
        <p>
            This query retrieves all rows from both tables:
        </p>
        <ul>
            <li>John Doe and Jane Smith have matching orders (101 and 102).</li>
            <li>Emily Johnson has no orders, so her Order ID is <strong>NULL</strong>.</li>
            <li>Order 103 has no matching customer, so the Customer Name is <strong>NULL</strong>.</li>
        </ul>
    </div>
    <div class="join-section">
        <h2>SELF JOIN</h2>
        <p>
            A <strong>SELF JOIN</strong> is a join where a table is joined with itself. It is useful for comparing rows within the same table, such as finding relationships or hierarchical structures.
        </p>
    
        <h3>Example Scenario</h3>
        <p>Consider the following Employee table:</p>
        <div class="example-tables">
            <div class="table-wrapper" style="display: inline-block; width: 50%; margin: 0 auto;">
                <h4>Employee Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Employee ID</th>
                            <th>Employee Name</th>
                            <th>Manager ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>John Doe</td><td>NULL</td></tr>
                        <tr><td>2</td><td>Jane Smith</td><td>1</td></tr>
                        <tr><td>3</td><td>Emily Johnson</td><td>1</td></tr>
                        <tr><td>4</td><td>Michael Brown</td><td>2</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    
        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT e1.employee_name AS Employee, e2.employee_name AS Manager
    FROM employee AS e1
    LEFT JOIN employee AS e2
    ON e1.manager_id = e2.employee_id;</code></pre>
        </div>
    
        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 60%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Employee</th>
                    <th>Manager</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>John Doe</td><td>NULL</td></tr>
                <tr><td>Jane Smith</td><td>John Doe</td></tr>
                <tr><td>Emily Johnson</td><td>John Doe</td></tr>
                <tr><td>Michael Brown</td><td>Jane Smith</td></tr>
            </tbody>
        </table>
    
        <h3>Visual Representation</h3>
        <div class="joins-visual" style="text-align: center;">
            <svg viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg" class="join-diagram" style="width: 80%; max-width: 300px; height: auto;">
                <circle cx="150" cy="75" r="60" fill="#3498db" fill-opacity="0.6" />
                <text x="150" y="80" font-size="12" fill="#fff" text-anchor="middle">Employee Table</text>
            </svg>
            <p>
                The single circle represents the Employee table. Each row in the table can join with other rows based on the Manager ID.
            </p>
        </div>
    
        <h3>Explanation</h3>
        <p>
            This query compares rows within the Employee table to find relationships between employees and their managers:
        </p>
        <ul>
            <li>John Doe has no manager, so the Manager column is <strong>NULL</strong>.</li>
            <li>Jane Smith and Emily Johnson report to John Doe.</li>
            <li>Michael Brown reports to Jane Smith.</li>
        </ul>
    </div>
    <div class="join-section">
        <h2>CROSS JOIN</h2>
        <p>
            A <strong>CROSS JOIN</strong> produces the Cartesian product of two tables, combining each row from the first table with every row from the second table. This join is useful in scenarios like generating combinations or exploring all possible pairings between two datasets.
        </p>
    
        <h3>Example Scenario</h3>
        <p>Consider the following two tables:</p>
        <div class="example-tables">
            <div class="table-wrapper" style="display: inline-block; width: 45%; margin-right: 5%;">
                <h4>Products Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Product ID</th>
                            <th>Product Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>T-Shirt</td></tr>
                        <tr><td>2</td><td>Jeans</td></tr>
                    </tbody>
                </table>
            </div>
    
            <div class="table-wrapper" style="display: inline-block; width: 45%;">
                <h4>Sizes Table</h4>
                <table class="data-table compact-table">
                    <thead>
                        <tr>
                            <th>Size ID</th>
                            <th>Size</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>Small</td></tr>
                        <tr><td>2</td><td>Medium</td></tr>
                        <tr><td>3</td><td>Large</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    
        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT products.product_name, sizes.size
    FROM products
    CROSS JOIN sizes;</code></pre>
        </div>
    
        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 60%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Product Name</th>
                    <th>Size</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>T-Shirt</td><td>Small</td></tr>
                <tr><td>T-Shirt</td><td>Medium</td></tr>
                <tr><td>T-Shirt</td><td>Large</td></tr>
                <tr><td>Jeans</td><td>Small</td></tr>
                <tr><td>Jeans</td><td>Medium</td></tr>
                <tr><td>Jeans</td><td>Large</td></tr>
            </tbody>
        </table>
    
        <h3>Visual Representation</h3>
        <div class="joins-visual" style="text-align: center;">
            <svg viewBox="0 0 300 150" xmlns="http://www.w3.org/2000/svg" class="join-diagram" style="width: 80%; max-width: 300px; height: auto;">
                <circle cx="100" cy="75" r="60" fill="#3498db" fill-opacity="0.6" />
                <circle cx="200" cy="75" r="60" fill="#e74c3c" fill-opacity="0.6" />
                <text x="100" y="75" font-size="12" fill="#fff" text-anchor="middle">Products</text>
                <text x="200" y="75" font-size="12" fill="#fff" text-anchor="middle">Sizes</text>
                <line x1="100" y1="75" x2="200" y2="75" stroke="#fff" stroke-width="2" />
            </svg>
            <p>
                The Cartesian product connects every row in the <strong>Products</strong> table with every row in the <strong>Sizes</strong> table.
            </p>
        </div>
    
        <h3>Explanation</h3>
        <p>
            This query generates all possible combinations of products and sizes:
        </p>
        <ul>
            <li>A <strong>T-Shirt</strong> is available in <strong>Small</strong>, <strong>Medium</strong>, and <strong>Large</strong>.</li>
            <li><strong>Jeans</strong> are also available in all three sizes.</li>
            <li>This is useful for creating a product catalog with every size variation for each item.</li>
        </ul>
    </div>
    
</section>


<!-- Intermediate SQL Content: GROUP BY and HAVING Clauses -->
<section id="group-by" class="margin-lg padding-md box-shadow">
    <h1>SQL GROUP BY: Aggregating Data</h1>
    <p>
        The <strong>GROUP BY</strong> statement is used to arrange identical data into groups. It is commonly used with aggregate functions like <code>SUM</code>, <code>COUNT</code>, <code>AVG</code>, <code>MAX</code>, and <code>MIN</code> to perform operations on groups of data.
    </p>

    <h2>Why Use GROUP BY?</h2>
    <ul>
        <li>To summarize large datasets by aggregating values.</li>
        <li>To gain insights into data patterns or trends.</li>
        <li>To organize data for reporting and analysis purposes.</li>
    </ul>

    <hr>

    <!-- Example 1 -->
    <div class="group-section">
        <h2>Example 1: Total Sales by City</h2>
        <p>Consider the following <strong>Sales</strong> table:</p>

        <div class="table-wrapper" style="width: 60%; margin: 0 auto;">
            <table class="data-table compact-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>City</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>New York</td><td>150</td></tr>
                    <tr><td>2</td><td>Los Angeles</td><td>200</td></tr>
                    <tr><td>3</td><td>New York</td><td>100</td></tr>
                    <tr><td>4</td><td>Chicago</td><td>300</td></tr>
                    <tr><td>5</td><td>Los Angeles</td><td>250</td></tr>
                </tbody>
            </table>
        </div>

        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT city, SUM(amount) AS total_sales
FROM sales
GROUP BY city;</code></pre>
        </div>

        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>City</th>
                    <th>Total Sales</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>New York</td><td>250</td></tr>
                <tr><td>Los Angeles</td><td>450</td></tr>
                <tr><td>Chicago</td><td>300</td></tr>
            </tbody>
        </table>

        <h3>Explanation</h3>
        <p>
            This query groups the data by the <strong>City</strong> column and calculates the total sales for each city:
        </p>
        <ul>
            <li><strong>New York</strong> has total sales of 150 + 100 = 250.</li>
            <li><strong>Los Angeles</strong> has total sales of 200 + 250 = 450.</li>
            <li><strong>Chicago</strong> has total sales of 300.</li>
        </ul>
    </div>

    <hr>

    <!-- Example 2 -->
    <div class="group-section">
        <h2>Example 2: Average Salary by Department</h2>
        <p>Consider the following <strong>Employees</strong> table:</p>

        <div class="table-wrapper" style="width: 60%; margin: 0 auto;">
            <table class="data-table compact-table">
                <thead>
                    <tr>
                        <th>Employee ID</th>
                        <th>Department</th>
                        <th>Salary</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>IT</td><td>80000</td></tr>
                    <tr><td>2</td><td>HR</td><td>60000</td></tr>
                    <tr><td>3</td><td>Finance</td><td>75000</td></tr>
                    <tr><td>4</td><td>IT</td><td>90000</td></tr>
                    <tr><td>5</td><td>Finance</td><td>85000</td></tr>
                </tbody>
            </table>
        </div>

        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT department, AVG(salary) AS average_salary
FROM employees
GROUP BY department;</code></pre>
        </div>

        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>Department</th>
                    <th>Average Salary</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>IT</td><td>85000</td></tr>
                <tr><td>HR</td><td>60000</td></tr>
                <tr><td>Finance</td><td>80000</td></tr>
            </tbody>
        </table>

        <h3>Explanation</h3>
        <p>
            This query groups the data by the <strong>Department</strong> column and calculates the average salary for each department:
        </p>
        <ul>
            <li>The average salary for <strong>IT</strong> is (80000 + 90000) / 2 = 85000.</li>
            <li>The average salary for <strong>HR</strong> is 60000.</li>
            <li>The average salary for <strong>Finance</strong> is (75000 + 85000) / 2 = 80000.</li>
        </ul>
    </div>
</section>

<section id="having-close" class="margin-lg padding-md box-shadow">
    <h1>SQL HAVING CLOSE: Refining Grouped Results</h1>
    <p>
        The <strong>HAVING CLOSE</strong> statement is not a standard SQL clause. However, to refine grouped results, SQL uses the <strong>HAVING</strong> clause in conjunction with the <strong>GROUP BY</strong> statement. <strong>HAVING</strong> is used to filter grouped results based on conditions applied to aggregated values.
    </p>

    <h2>Why Use HAVING with GROUP BY?</h2>
    <ul>
        <li>To filter grouped data based on aggregated values.</li>
        <li>To exclude groups that don't meet specific criteria.</li>
        <li>To further analyze data after initial grouping and aggregation.</li>
    </ul>

    <hr>

    <!-- Example 1: Filtering Total Sales by City -->
    <div class="having-section">
        <h2>Example 1: Cities with Total Sales Over $400</h2>
        <p>Using the previous <strong>Sales</strong> table:</p>

        <div class="table-wrapper" style="width: 60%; margin: 0 auto;">
            <table class="data-table compact-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>City</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>New York</td><td>150</td></tr>
                    <tr><td>2</td><td>Los Angeles</td><td>200</td></tr>
                    <tr><td>3</td><td>New York</td><td>100</td></tr>
                    <tr><td>4</td><td>Chicago</td><td>300</td></tr>
                    <tr><td>5</td><td>Los Angeles</td><td>250</td></tr>
                </tbody>
            </table>
        </div>

        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT city, SUM(amount) AS total_sales
FROM sales
GROUP BY city
HAVING SUM(amount) > 400;</code></pre>
        </div>

        <h3>Result</h3>
        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
            <thead>
                <tr>
                    <th>City</th>
                    <th>Total Sales</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Los Angeles</td><td>450</td></tr>
                <tr><td>Chicago</td><td>300</td></tr>
            </tbody>
        </table>

        <h3>Explanation</h3>
        <p>
            This query groups sales by city, calculates the total sales for each, and then filters the results to only include cities with total sales exceeding $400.
        </p>
    </div>

    <hr>

    <!-- Example 2: Average Salary Threshold -->
    <div class="having-section">
        <h2>Example 2: Departments with Average Salary Over $80,000</h2>
        <p>Using the previous <strong>Employees</strong> table:</p>

        <div class="table-wrapper" style="width: 60%; margin: 0 auto;">
            <table class="data-table compact-table">
                <thead>
                    <tr>
                        <th>Employee ID</th>
                        <th>Department</th>
                        <th>Salary</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>IT</td><td>80000</td></tr>
                    <tr><td>2</td><td>HR</td><td>60000</td></tr>
                    <tr><td>3</td><td>Finance</td><td>75000</td></tr>
                    <tr><td>4</td><td>IT</td><td>90000</td></tr>
                    <tr><td>5</td><td>Finance</td><td>85000</td></tr>
                </tbody>
            </table>
        </div>

        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT department, AVG(salary) AS average_salary
                FROM employees
                GROUP BY department
                HAVING AVG(salary) > 80000;</code></pre>
                        </div>
                
                        <h3>Result</h3>
                        <table class="data-table compact-table" style="width: 50%; margin: 0 auto;">
                            <thead>
                                <tr>
                                    <th>Department</th>
                                    <th>Average Salary</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>IT</td><td>85000</td></tr>
                                <tr><td>Finance</td><td>80000</td></tr>
                            </tbody>
                        </table>
                
                        <h3>Explanation</h3>
                        <p>
                            This query groups employees by department, calculates the average salary for each, and then filters the results to only include departments with an average salary exceeding $80,000.
                        </p>
    </div>
    <div class="having-section">
        <h2>Example 3: Filtering by Multiple Conditions</h2>
        <p>Find departments with an average salary over $70,000 and fewer than 3 employees:</p>
    
        <h3>Query</h3>
        <div class="code-box">
            <pre><code>SELECT department, AVG(salary) AS average_salary, COUNT(*) AS num_employees
    FROM employees
    GROUP BY department
    HAVING AVG(salary) > 70000 AND COUNT(*) < 3;</code></pre>
        </div>
    
        <h3>Result</h3>
        <!-- Result table would be placed here, assuming there are matching records -->
    
        <h3>Explanation</h3>
        <p>
            This query demonstrates using `HAVING` with multiple conditions to refine the results further.
        </p>
    </div>
    
</section> 
                
<!-- Intermediate SQL Content: Indexing and Constraints -->
<section id="indexing-constraints">
    <h2>Indexing</h2>
    <p><strong>Definition:</strong> An index is a data structure that improves the speed of data retrieval operations.</p>
    <p><strong>Purpose:</strong> Enhance query performance by allowing the database to quickly locate data.</p>

    <h3>Types of Indexes</h3>

    <h4>B-Tree Index</h4>
    <p><strong>Definition:</strong> A self-balancing search tree that keeps data sorted.</p>
    <p><strong>Use Case:</strong> Frequently queried columns with a large number of distinct values.</p>
    <div class="code-box">
        <pre><code>CREATE INDEX idx_employee_id ON employees (employee_id);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This creates a B-Tree index on the <code>employee_id</code> column of the <code>employees</code> table, which helps speed up queries that search for specific employee IDs.</p>

    <h4>Hash Index</h4>
    <p><strong>Definition:</strong> A data structure that stores the values of a column and their corresponding locations.</p>
    <p><strong>Use Case:</strong> Columns used in equality searches (e.g., <code>WHERE column = 'value'</code>).</p>
    <div class="code-box">
        <pre><code>CREATE INDEX idx_order_status ON orders (order_status) USING HASH;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This creates a hash index on the <code>order_status</code> column of the <code>orders</code> table, which is efficient for queries that check for specific order statuses.</p>

    <h4>Full-Text Index</h4>
    <p><strong>Definition:</strong> An index designed for full-text search queries.</p>
    <p><strong>Use Case:</strong> Searching for words or phrases within text data.</p>
    <div class="code-box">
        <pre><code>CREATE FULLTEXT INDEX idx_product_description ON products (product_description);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This creates a full-text index on the <code>product_description</code> column of the <code>products</code> table, which helps speed up searches for specific words or phrases within product descriptions.</p>

    <h4>Composite Index</h4>
    <p><strong>Definition:</strong> An index created on multiple columns.</p>
    <p><strong>Use Case:</strong> Frequently queried combinations of columns.</p>
    <div class="code-box">
        <pre><code>CREATE INDEX idx_customer_name_email ON customers (customer_name, customer_email);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This creates a composite index on the <code>customer_name</code> and <code>customer_email</code> columns of the <code>customers</code> table, which helps speed up queries that filter or sort by both columns.</p>

    <h2>Primary Key (PK) Constraints</h2>
    <p><strong>Definition:</strong> A constraint that uniquely identifies each record in a table.</p>
    <p><strong>Characteristics:</strong></p>
    <ul>
        <li>Unique</li>
        <li>Not Null</li>
        <li>Indexed (by default)</li>
    </ul>
    <p><strong>Purpose:</strong> Ensure data integrity and prevent duplicate records.</p>
    <div class="code-box">
        <pre><code>CREATE TABLE employees (
  employee_id INT PRIMARY KEY,
  employee_name VARCHAR(255),
  employee_email VARCHAR(255)
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This creates a table <code>employees</code> with a primary key constraint on the <code>employee_id</code> column, ensuring each employee has a unique ID.</p>

    <h2>Foreign Key (FK) Constraints</h2>
    <p><strong>Definition:</strong> A constraint that establishes a relationship between two tables.</p>
    <p><strong>Characteristics:</strong></p>
    <ul>
        <li>References the Primary Key of another table</li>
        <li>Ensures data consistency across tables</li>
    </ul>
    <p><strong>Purpose:</strong> Maintain referential integrity between related tables.</p>
    <div class="code-box">
        <pre><code>CREATE TABLE customers (
  customer_id INT PRIMARY KEY,
  customer_name VARCHAR(255),
  customer_email VARCHAR(255)
);

CREATE TABLE orders (
  order_id INT PRIMARY KEY,
  customer_id INT,
  FOREIGN KEY (customer_id) REFERENCES customers (customer_id)
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This creates two tables, <code>customers</code> and <code>orders</code>, with a foreign key constraint on the <code>customer_id</code> column in the <code>orders</code> table, ensuring that each order is associated with a valid customer.</p>

    <h2>Unique, Not Null, Check Constraints</h2>

    <h3>Unique Constraint</h3>
    <p><strong>Definition:</strong> Ensures all values in a column are unique.</p>
    <div class="code-box">
        <pre><code>CREATE TABLE employees (
  employee_id INT,
  employee_email VARCHAR(255) UNIQUE,
  ...
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This ensures that each email address in the <code>employee_email</code> column is unique, preventing duplicate email addresses.</p>

    <h3>Not Null Constraint</h3>
    <p><strong>Definition:</strong> Ensures a column cannot contain null values.</p>
    <div class="code-box">
        <pre><code>CREATE TABLE employees (
  employee_id INT NOT NULL,
  employee_name VARCHAR(255),
  ...
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This ensures that the <code>employee_id</code> column cannot have null values, meaning every employee must have an ID.</p>

    <h3>Check Constraint</h3>
    <p><strong>Definition:</strong> Ensures all values in a column meet a specified condition.</p>
    <div class="code-box">
        <pre><code>CREATE TABLE employees (
  employee_id INT,
  employee_age INT CHECK (employee_age >= 18),
  ...
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This ensures that the <code>employee_age</code> column only contains values that are 18 or older, enforcing a minimum age requirement.</p>

    <h3>Key Takeaways:</h3>
    <ul>
        <li><strong>Indexing:</strong> Enhances query performance by allowing the database to quickly locate data.</li>
        <li><strong>Constraints:</strong></li>
        <ul>
            <li><strong>Primary Key:</strong> Uniquely identifies each record in a table.</li>
            <li><strong>Foreign Key:</strong> Establishes a relationship between two tables.</li>
            <li><strong>Unique, Not Null, Check:</strong> Ensure data integrity and consistency.</li>
        </ul>
    </ul>
</section>


<!-- Intermediate SQL Content: Views and Stored Procedures -->
<section id="views-stored-procedures">
    <h2>Creating and Using Views</h2>
    <p><strong>Definition:</strong> A virtual table based on the result-set of a query.</p>
    <p><strong>Purpose:</strong> Simplify complex queries, provide data abstraction, and enhance security.</p>
    <p><strong>Syntax:</strong></p>
    <div class="code-box">
        <pre><code>CREATE VIEW view_name AS SELECT ...;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 1: Create a View for Employee Salaries</strong></p>
    <div class="code-box">
        <pre><code>CREATE VIEW employee_salaries AS
SELECT employee_name, salary, department
FROM employees
WHERE salary &gt; 50000;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This view filters employees with salaries greater than 50,000. It simplifies querying high-salary employees without repeatedly writing the same query.</p>
    <p><strong>Query the View:</strong></p>
    <div class="code-box">
        <pre><code>SELECT * FROM employee_salaries;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 2: Create a View for Order Totals by Customer</strong></p>
    <div class="code-box">
        <pre><code>CREATE VIEW customer_order_totals AS
SELECT customer_name, SUM(total_amount) AS total_spent
FROM customers
JOIN orders ON customers.customer_id = orders.customer_id
GROUP BY customer_name;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This view calculates the total amount spent by each customer, making it easier to analyze customer spending patterns.</p>
    <p><strong>Query the View:</strong></p>
    <div class="code-box">
        <pre><code>SELECT * FROM customer_order_totals;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 3: Create a View for Product Inventory Levels</strong></p>
    <div class="code-box">
        <pre><code>CREATE VIEW product_inventory AS
SELECT product_name, quantity_in_stock
FROM products
WHERE quantity_in_stock &lt; 10;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This view lists products with low inventory levels, helping in inventory management.</p>
    <p><strong>Query the View:</strong></p>
    <div class="code-box">
        <pre><code>SELECT * FROM product_inventory;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 4: Create a View for Active Projects</strong></p>
    <div class="code-box">
        <pre><code>CREATE VIEW active_projects AS
SELECT project_name, start_date, end_date
FROM projects
WHERE end_date IS NULL OR end_date &gt; CURRENT_DATE;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This view shows all active projects, making it easier to track ongoing work.</p>
    <p><strong>Query the View:</strong></p>
    <div class="code-box">
        <pre><code>SELECT * FROM active_projects;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <h2>Creating and Executing Stored Procedures</h2>
    <p><strong>Definition:</strong> A reusable block of SQL code that performs a specific task.</p>
    <p><strong>Purpose:</strong> Enhance database security, reduce code duplication, and improve performance.</p>
    <p><strong>Syntax:</strong></p>
    <div class="code-box">
        <pre><code>CREATE PROCEDURE procedure_name AS BEGIN ... END;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 1: Create a Stored Procedure for Inserting New Employees</strong></p>
    <div class="code-box">
        <pre><code>CREATE PROCEDURE sp_insert_employee(
  IN employee_name VARCHAR(255),
  IN salary DECIMAL(10, 2),
  IN department VARCHAR(255)
)
BEGIN
  INSERT INTO employees (employee_name, salary, department)
  VALUES (employee_name, salary, department);
END;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This stored procedure inserts a new employee into the <code>employees</code> table, encapsulating the insert logic.</p>
    <p><strong>Execute the Stored Procedure:</strong></p>
    <div class="code-box">
        <pre><code>CALL sp_insert_employee('New Employee', 40000.00, 'Sales');</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 2: Create a Stored Procedure for Updating Order Status</strong></p>
    <div class="code-box">
        <pre><code>CREATE PROCEDURE sp_update_order_status(
  IN order_id INT,
  IN new_status VARCHAR(255)
)
BEGIN
  UPDATE orders
  SET status = new_status
  WHERE order_id = order_id;
END;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This stored procedure updates the status of an order, making it easier to manage order statuses.</p>
    <p><strong>Execute the Stored Procedure:</strong></p>
    <div class="code-box">
        <pre><code>CALL sp_update_order_status(123, 'Shipped');</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 3: Create a Stored Procedure for Generating Sales Reports</strong></p>
    <div class="code-box">
        <pre><code>CREATE PROCEDURE sp_generate_sales_report(
  IN start_date DATE,
  IN end_date DATE
)
BEGIN
  SELECT *
  FROM orders
  WHERE order_date BETWEEN start_date AND end_date;
END;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This stored procedure generates a sales report for a specified date range, simplifying report generation.</p>
    <p><strong>Execute the Stored Procedure:</strong></p>
    <div class="code-box">
        <pre><code>CALL sp_generate_sales_report('2022-01-01', '2022-12-31');</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <p><strong>Example 4: Create a Stored Procedure for Deleting Old Records</strong></p>
    <div class="code-box">
        <pre><code>CREATE PROCEDURE sp_delete_old_records(
  IN cutoff_date DATE
)
BEGIN
  DELETE FROM logs
  WHERE log_date &lt; cutoff_date;
END;</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> This stored procedure deletes records from the <code>logs</code> table that are older than a specified date, helping in database maintenance.</p>
    <p><strong>Execute the Stored Procedure:</strong></p>
    <div class="code-box">
        <pre><code>CALL sp_delete_old_records('2023-01-01');</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <h3>Key Takeaways:</h3>
    <ul>
        <li><strong>Views:</strong> Simplify complex queries and provide data abstraction.</li>
        <li><strong>Stored Procedures:</strong> Improve database security, reduce code duplication, and enhance performance.</li>
    </ul>
</section>


<!-- Intermediate SQL Content: Database Design -->
<section id="database-design">
    <h1>Designing Databases with Ease - An Introduction</h1>

    <h2>Introduction to Database Design</h2>
    <p><strong>Definition:</strong> The process of creating a conceptual representation of a database.</p>
    <p><strong>Goal:</strong> Ensure data consistency, reduce data redundancy, and improve data integrity.</p>
    <p><strong>Key Considerations:</strong></p>
    <ul>
        <li><strong>Data Requirements:</strong> Identify the data needed to support business processes.</li>
        <li><strong>Data Relationships:</strong> Define how data entities interact with each other.</li>
        <li><strong>Data Constraints:</strong> Establish rules to maintain data consistency.</li>
    </ul>

    <h2>Entity-Relationship Modeling (ERM)</h2>
    <p><strong>Definition:</strong> A methodology for designing databases using entities, attributes, and relationships.</p>
    <p><strong>Components:</strong></p>
    <ul>
        <li><strong>Entities:</strong> Represent tables or objects in the database (e.g., Customers, Orders).</li>
        <li><strong>Attributes:</strong> Describe the characteristics of entities (e.g., Customer Name, Order Date).</li>
        <li><strong>Relationships:</strong> Define how entities interact with each other (e.g., One-to-Many, Many-to-Many).</li>
    </ul>
    <p><strong>ERM Notation:</strong></p>
    <ul>
        <li><strong>Entities:</strong> Rectangles</li>
        <li><strong>Attributes:</strong> List inside the entity rectangle</li>
        <li><strong>Relationships:</strong></li>
        <ul>
            <li><strong>One-to-Many (1:N):</strong> Single line with a crow's foot</li>
            <li><strong>Many-to-Many (M:N):</strong> Two crow's feet</li>
            <li><strong>One-to-One (1:1):</strong> Single line without a crow's foot</li>
        </ul>
    </ul>

    <p><strong>Example: ERM Diagram for an E-commerce Database</strong></p>
    <ul>
        <li><strong>Entities:</strong></li>
        <ul>
            <li><strong>Customers</strong></li>
            <ul>
                <li>Attributes: Customer ID, Name, Email, Address</li>
            </ul>
            <li><strong>Orders</strong></li>
            <ul>
                <li>Attributes: Order ID, Customer ID, Order Date, Total</li>
            </ul>
            <li><strong>Products</strong></li>
            <ul>
                <li>Attributes: Product ID, Name, Description, Price</li>
            </ul>
        </ul>
        <li><strong>Relationships:</strong></li>
        <ul>
            <li>Customers (1:N) Orders</li>
            <li>Orders (M:N) Products</li>
        </ul>
    </ul>

    <h2>Normalization (1NF, 2NF, 3NF)</h2>
    <p><strong>Definition:</strong> The process of organizing data to minimize data redundancy and dependency.</p>
    <p><strong>Normalization Forms:</strong></p>
    <ol>
        <li><strong>First Normal Form (1NF)</strong></li>
        <li><strong>Second Normal Form (2NF)</strong></li>
        <li><strong>Third Normal Form (3NF)</strong></li>
    </ol>

    <h3>First Normal Form (1NF)</h3>
    <p><strong>Definition:</strong> Each table cell contains a single, atomic value.</p>
    <p><strong>Example:</strong></p>
    <p><strong>Before 1NF:</strong></p>
    <div class="code-box">
        <pre><code>Customers: Customer ID, Name, Phone Numbers (123-456-7890, 987-654-3210)</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>After 1NF:</strong></p>
    <div class="code-box">
        <pre><code>Customers: Customer ID, Name
Phone Numbers: Customer ID, Phone Number</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> In 1NF, each cell must contain only one value. The phone numbers are split into a separate table to ensure atomicity.</p>

    <h3>Second Normal Form (2NF)</h3>
    <p><strong>Definition:</strong> Each non-key attribute depends on the entire primary key.</p>
    <p><strong>Example:</strong></p>
    <p><strong>Before 2NF:</strong></p>
    <div class="code-box">
        <pre><code>Orders: Order ID, Customer ID, Order Date, Customer Name</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>After 2NF:</strong></p>
    <div class="code-box">
        <pre><code>Orders: Order ID, Customer ID, Order Date
Customers: Customer ID, Customer Name</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> In 2NF, all non-key attributes must depend on the entire primary key. Customer Name is moved to the Customers table because it depends only on Customer ID.</p>

    <h3>Third Normal Form (3NF)</h3>
    <p><strong>Definition:</strong> If a table is in 2NF, and a non-key attribute depends on another non-key attribute, then it should be moved to a separate table.</p>
    <p><strong>Example:</strong></p>
    <p><strong>Before 3NF:</strong></p>
    <div class="code-box">
        <pre><code>Products: Product ID, Name, Description, Supplier Name, Supplier Address</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>After 3NF:</strong></p>
    <div class="code-box">
        <pre><code>Products: Product ID, Name, Description, Supplier ID
Suppliers: Supplier ID, Supplier Name, Supplier Address</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <p><strong>Explanation:</strong> In 3NF, non-key attributes that depend on other non-key attributes are moved to a separate table. Supplier Name and Supplier Address are moved to the Suppliers table.</p>

    <h3>Key Takeaways:</h3>
    <ul>
        <li><strong>Database Design:</strong></li>
        <ul>
            <li>Identify data requirements and relationships.</li>
            <li>Establish data constraints to maintain consistency.</li>
        </ul>
        <li><strong>Entity-Relationship Modeling (ERM):</strong></li>
        <ul>
            <li>Use entities, attributes, and relationships to design databases.</li>
            <li>Apply ERM notation to create visual diagrams.</li>
        </ul>
        <li><strong>Normalization:</strong></li>
        <ul>
            <li>Apply 1NF, 2NF, and 3NF to minimize data redundancy and dependency.</li>
            <li>Ensure data integrity and scalability.</li>
        </ul>
    </ul>
</section>


<!-- Intermediate SQL Content: Subqueries -->
<section id="subqueries">
    <h2>What are Subqueries?</h2>
    <p><strong>Definition:</strong> A query nested inside another query, used to further restrict or enhance the results.</p>
    <p><strong>Purpose:</strong> To answer complex questions that cannot be solved with a single query.</p>

    <h2>Types of Subqueries</h2>
    <ol>
        <li>Single-Row Subquery</li>
        <li>Multiple-Row Subquery</li>
        <li>Correlated Subquery</li>
    </ol>

    <h3>Single-Row Subquery</h3>
    <p><strong>Definition:</strong> Returns only one row and one column.</p>
    <p><strong>Examples:</strong></p>
    <div class="code-box">
        <pre><code>-- Find the employee with the highest salary
SELECT *
FROM employees
WHERE salary = (
  SELECT MAX(salary)
  FROM employees
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Get the average order value for customers from New York
SELECT *
FROM customers
WHERE customer_id = (
  SELECT customer_id
  FROM orders
  WHERE total_amount = (
    SELECT AVG(total_amount)
    FROM orders
    WHERE customer_state = 'NY'
  )
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Find the product with the lowest price
SELECT *
FROM products
WHERE price = (
  SELECT MIN(price)
  FROM products
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Get the customer with the highest total orders
SELECT *
FROM customers
WHERE customer_id = (
  SELECT customer_id
  FROM orders
  GROUP BY customer_id
  ORDER BY SUM(total_amount) DESC
  LIMIT 1
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Find the employee with the longest tenure
SELECT *
FROM employees
WHERE hire_date = (
  SELECT MIN(hire_date)
  FROM employees
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <h3>Multiple-Row Subquery</h3>
    <p><strong>Definition:</strong> Returns one or more rows and one or more columns.</p>
    <p><strong>Examples:</strong></p>
    <div class="code-box">
        <pre><code>-- Find all employees with salaries above the average
SELECT *
FROM employees
WHERE salary &gt; (
  SELECT AVG(salary)
  FROM employees
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Get all orders with total amounts above $100
SELECT *
FROM orders
WHERE total_amount &gt; (
  SELECT AVG(total_amount)
  FROM orders
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Find all products with prices below the minimum
SELECT *
FROM products
WHERE price &lt; (
  SELECT MIN(price)
  FROM products
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Get all customers with orders in New York
SELECT *
FROM customers
WHERE customer_id IN (
  SELECT customer_id
  FROM orders
  WHERE customer_state = 'NY'
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Find all employees with job titles in the IT department
SELECT *
FROM employees
WHERE job_title IN (
  SELECT job_title
  FROM job_titles
  WHERE department = 'IT'
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <h3>Correlated Subqueries</h3>
    <p><strong>Definition:</strong> A subquery that depends on the outer query for its values.</p>
    <p><strong>Examples:</strong></p>
    <div class="code-box">
        <pre><code>-- Find all employees with salaries above the average for their department
SELECT *
FROM employees e
WHERE salary &gt; (
  SELECT AVG(salary)
  FROM employees
  WHERE department = e.department
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Get all orders with total amounts above the average for each customer
SELECT *
FROM orders o
WHERE total_amount &gt; (
  SELECT AVG(total_amount)
  FROM orders
  WHERE customer_id = o.customer_id
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Find all products with prices below the minimum for each category
SELECT *
FROM products p
WHERE price &lt; (
  SELECT MIN(price)
  FROM products
  WHERE category = p.category
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Get all customers with orders above the average for each region
SELECT *
FROM customers c
WHERE customer_id IN (
  SELECT customer_id
  FROM orders
  WHERE total_amount &gt; (
    SELECT AVG(total_amount)
    FROM orders
    WHERE customer_region = c.customer_region
  )
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>
    <div class="code-box">
        <pre><code>-- Find all employees with job titles in the top 3 for each department
SELECT *
FROM employees e
WHERE job_title IN (
  SELECT job_title
  FROM job_titles
  WHERE department = e.department
  ORDER BY salary DESC
  LIMIT 3
);</code></pre>
        <button class="copy-button" onclick="copyCode(this)"><i class="fas fa-copy"></i> Copy Code</button>
    </div>

    <h3>Key Takeaways:</h3>
    <ul>
        <li><strong>Single-Row Subquery:</strong> Returns one row and one column.</li>
        <li><strong>Multiple-Row Subquery:</strong> Returns one or more rows and one or more columns.</li>
        <li><strong>Correlated Subquery:</strong> Depends on the outer query for its values.</li>
    </ul>
</section>

<section class="padding-lg" id="customer-insights">
    <h2 class="font-weight-bold margin-lg text-align-center">Unlocking the Value of Your Customer Base: A Deep Dive into Purchase Behavior Analysis</h2>
  
    <div class="code-box margin-lg">
      <h3 class="header">The Query: Unveiling High-Value Customers</h3>
      <pre>
        <code>
  SELECT 
    customers.customer_name,
    SUM(orders.total_amount) AS total_spent,
    AVG(orders.total_amount) AS average_order_value
  FROM 
    customers
    JOIN orders ON customers.customer_id = orders.customer_id
  WHERE 
    orders.order_date >= '2022-01-01'
  GROUP BY 
    customers.customer_name
  HAVING 
    SUM(orders.total_amount) > 1000
  ORDER BY 
    total_spent DESC;
        </code>
      </pre>
    </div>
  
    <div class="padding-md background-color-f9f9f9 border-radius border-1px-solid-dde0e3 box-shadow">
      <h3>Breaking Down the Query:</h3>
      <ul>
        <li><strong>SELECT:</strong> We're interested in the customer's name, the total amount they've spent (total_spent), and the average value of their orders (average_order_value).</li>
        <li><strong>FROM & JOIN:</strong> We combine data from the customers and orders tables based on the customer_id to link each customer with their respective orders.</li>
        <li><strong>WHERE:</strong> We focus on orders made from the start of 2022 onwards, ensuring our analysis reflects recent purchase behavior.</li>
        <li><strong>GROUP BY:</strong> We aggregate the data by customer_name, allowing us to analyze each customer's purchase behavior individually.</li>
        <li><strong>HAVING:</strong> We filter the results to only include customers who have spent more than $1000, identifying our high-value customers.</li>
        <li><strong>ORDER BY:</strong> We sort these high-value customers in descending order based on total_spent, highlighting our most lucrative customers at the top.</li>
      </ul>
    </div>
  
    <div class="padding-md background-color-f9f9f9 border-radius border-1px-solid-dde0e3 box-shadow margin-top-md">
      <h3>Unpacking the Insights:</h3>
      <ul>
        <li><strong>Total Spent (total_spent):</strong> Immediately identifies the cumulative value each high-value customer has brought to your business since 2022.</li>
        <li><strong>Average Order Value (average_order_value):</strong> Provides insight into the typical purchase size of these high-value customers, helping you understand their buying habits.</li>
      </ul>
    </div>
  
    <div class="padding-lg">
      <h2 class="font-weight-bold text-align-center">Actionable Advice: Further Segmenting High-Value Customers for Targeted Marketing</h2>
  
      <div class="data-table margin-lg">
        <table>
          <thead>
            <tr>
              <th>Analysis</th>
              <th>Query Adjustment</th>
              <th>Insight</th>
              <th>Marketing Strategy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Purchase Frequency Analysis</td>
              <td>Add COUNT(orders.order_id) AS number_of_orders to the SELECT clause.</td>
              <td>Reveals how often high-value customers make purchases, helping you determine the optimal frequency for promotional emails or loyalty program rewards.</td>
              <td>Offer exclusive, less frequent promotions to less active high-value customers to re-engage them.</td>
            </tr>
            <tr>
              <td>Product Preference Analysis</td>
              <td>Join with the order_items table and SELECT product_category.</td>
              <td>Uncovers the product categories high-value customers are most interested in.</td>
              <td>Tailor product recommendations in newsletters or on-site banners to these preferred categories for enhanced relevance.</td>
            </tr>
            <tr>
              <td>Geographic Segmentation</td>
              <td>Include customers.customer_location in the SELECT clause.</td>
              <td>Highlights the geographic distribution of your high-value customers.</td>
              <td>Launch location-specific promotions or partner with local businesses to cater to these valuable customers' regional preferences.</td>
            </tr>
            <tr>
                <td>Geographic Segmentation</td>
                <td>Include customers.customer_location in the SELECT clause.</td>
                <td>Highlights the geographic distribution of your high-value customers.</td>
                <td>Launch location-specific promotions or partner with local businesses to cater to these valuable customers' regional preferences.</td>
              </tr>
            </tbody>
          </table>
        </div>
    
        <div class="padding-md background-color-f9f9f9 border-radius border-1px-solid-dde0e3 box-shadow margin-top-md">
          <h3>Next Steps:</h3>
          <ul>
            <li><strong>Regularly Update Your Analysis:</strong> Schedule the query to run quarterly to capture changes in customer behavior over time.</li>
            <li><strong>Integrate with Marketing Tools:</strong> Use the insights gained to personalize your marketing automation workflows, ensuring each high-value customer receives content that resonates with their purchase behavior and preferences.</li>
            <li><strong>Monitor and Refine:</strong> Continuously assess the effectiveness of your targeted marketing efforts and refine your strategies based on the feedback and new insights gathered from your customer base.</li>
          </ul>
        </div>
    
        <div class="text-align-center margin-top-lg padding-bottom-lg">
          <button class="copy-button" onclick="copyQueryToClipboard()">Copy Query to Clipboard</button>
        </div>
      </div>
    </section>

    
    <section id="user-contributions" class="margin-lg padding-md box-shadow">
        <h2>Submit Your SQL Queries or Challenges</h2>
        <p>Have an interesting SQL query or challenge? Share it with us, and we might feature it on our site with credits to you!</p>
    
        <!-- Submission Form -->
        <form id="contribution-form" class="contribution-form">
            <label for="name">Your Name:</label>
            <input type="text" id="name" name="name" placeholder="Enter your name" required>
    
            <label for="email">Your Email:</label>
            <input type="email" id="email" name="email" placeholder="Enter your email" required>
    
            <label for="query">SQL Query/Challenge:</label>
            <textarea id="query" name="query" placeholder="Enter your SQL query or challenge here" rows="5" required></textarea>
    
            <button type="submit" class="btn-submit">Submit</button>
        </form>
    
        <!-- Featured Contributions -->
        <div id="featured-contributions" class="featured-contributions">
            <h3>Featured User Submissions</h3>
            <ul>
                <li><strong>John Doe:</strong> <em>"Write a query to find the top 5 highest-paid employees."</em></li>
                <li><strong>Jane Smith:</strong> <em>"Optimize a query to retrieve customer orders within the last 30 days."</em></li>
            </ul>
        </div>
        <style>
            /* User Contributions Section */
        #user-contributions {
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: var(--spacing-lg);
        }

        #user-contributions h2, #user-contributions h3 {
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: var(--spacing-md);
        }

        .contribution-form {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            max-width: 500px;
            margin: 0 auto;
        }

        .contribution-form label {
            font-weight: bold;
            color: var(--primary-color);
        }

        .contribution-form input, .contribution-form textarea {
            width: 100%;
            padding: var(--spacing-sm);
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            font-size: 1em;
        }

        .contribution-form button {
            background-color: var(--secondary-color);
            color: #fff;
            border: none;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .contribution-form button:hover {
            background-color: var(--accent-color);
        }

        .featured-contributions ul {
            list-style: none;
            padding: 0;
            margin: var(--spacing-lg) 0;
        }

        .featured-contributions ul li {
            margin-bottom: var(--spacing-sm);
            padding-left: 10px;
            position: relative;
        }

        .featured-contributions ul li::before {
            content: "★";
            position: absolute;
            left: -15px;
            color: var(--accent-color);
        }

        </style>

        <script>
            document.getElementById("contribution-form").addEventListener("submit", function(e) {
                e.preventDefault();
            
                // Get form values
                const name = document.getElementById("name").value;
                const query = document.getElementById("query").value;
            
                // Add the contribution to the featured list
                const contributions = document.getElementById("featured-contributions").querySelector("ul");
                const newContribution = document.createElement("li");
                newContribution.innerHTML = `<strong>${name}:</strong> <em>"${query}"</em>`;
                contributions.appendChild(newContribution);
            
                // Reset form
                this.reset();
            
                // Alert the user (optional)
                alert("Thank you for your contribution!");
            });
        </script>

    </section>


</div>

<footer class="footer">
    <p class="paragraph">Copyright 2023 TechyVia. All rights reserved.</p>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <script>
      const MOBILE_BREAKPOINT = 768;
      if (window.innerWidth <= MOBILE_BREAKPOINT) {
        document.write('<script src="mobile.js"><\/script>');
      }
    </script>
    
  
  <script src="script.js"></script>
</body>
</html>